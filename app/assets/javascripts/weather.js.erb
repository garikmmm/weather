<% environment.context_class.instance_eval { include Rails.application.routes.url_helpers} %>
$(function() {
    $('#forecast-form #location_id').selectize({
        valueField: 'id',
        labelField: 'name',
        searchField: 'name',
        create: true,
        load: function(query, callback) {
            if (!query.length) return callback();
            $.ajax({
                url: "<%= search_location_path %>/" + encodeURIComponent(query),
                type: 'GET',
                error: function() {
                    callback();
                },
                success: function(res) {
                    callback(res);
                }
            });
        }
    });

  $('#forecast-form').on('ajax:success', function(event, data) {
    $("#forecast-response").text(JSON.stringify(data));
  });
  $('#forecast-form').on('ajax:error', function(xhr, status, error) {
    $("#forecast-response").text('');
    alert(error);
  });
});

